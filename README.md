# è¨˜å¸³åˆ†æç¨‹å¼

é€™æ˜¯ä¸€å€‹ Python ç¨‹å¼ï¼Œç”¨æ–¼åˆ†æ Excel è¨˜å¸³æª”æ¡ˆï¼Œè¨ˆç®—å„é¡åˆ¥çš„ç¸½èŠ±è²»ä¸¦æ‰¾å‡ºèŠ±è²»æœ€å¤šçš„é¡åˆ¥ã€‚

## åŠŸèƒ½èªªæ˜

### ğŸ“Š è³‡æ–™åˆ†æï¼ˆanalyze_expenses.pyï¼‰

1. **è®€å– Excel è¨˜å¸³æª”æ¡ˆ** - å¾ `data/project_1_with_fake_data.xlsx` è®€å–è³‡æ–™
2. **è¨ˆç®—æ¯å€‹é¡åˆ¥çš„ç¸½èŠ±è²»** - çµ±è¨ˆå„é¡åˆ¥çš„ç¸½é‡‘é¡ã€ç­†æ•¸å’Œå¹³å‡èŠ±è²»
3. **æ‰¾å‡ºèŠ±æœ€å¤šéŒ¢çš„é¡åˆ¥** - è­˜åˆ¥èŠ±è²»æœ€é«˜çš„é¡åˆ¥
4. **è¼¸å‡ºåˆ†æçµæœ** - å°‡çµæœå„²å­˜è‡³æ–°çš„ Excel æª”æ¡ˆ `data/expense_analysis_result.xlsx`

### ğŸ“ˆ è³‡æ–™è¦–è¦ºåŒ–ï¼ˆvisualize_expenses.pyï¼‰

1. **åœ“é¤…åœ–** - é¡¯ç¤ºå„é¡åˆ¥èŠ±è²»ä½”æ¯”ï¼Œä½¿ç”¨ç¾è§€çš„é…è‰²
2. **é•·æ¢åœ–** - é¡¯ç¤ºæ¯æœˆèŠ±è²»è¶¨å‹¢ï¼Œæ¸…æ¥šå‘ˆç¾é‡‘é¡è®ŠåŒ–
3. **å †ç–Šåœ–** - é¡¯ç¤ºå„é¡åˆ¥æ¯æœˆèŠ±è²»åˆ†å¸ƒï¼ˆé¡å¤–åœ–è¡¨ï¼‰
4. **ä¸­æ–‡æ¨™ç±¤** - æ‰€æœ‰åœ–è¡¨éƒ½æœ‰æ¸…æ™°çš„ä¸­æ–‡æ¨™é¡Œå’Œæ¨™ç±¤

### ğŸ¯ äº’å‹•å¼å„€è¡¨æ¿ï¼ˆdashboard.pyï¼‰

1. **æª”æ¡ˆä¸Šå‚³** - æ”¯æ´æ‹–æ”¾æˆ–é»æ“Šä¸Šå‚³ Excel æª”æ¡ˆ
2. **å³æ™‚çµ±è¨ˆ** - è‡ªå‹•è¨ˆç®—ç¸½èŠ±è²»ã€å¹³å‡èŠ±è²»ã€ç­†æ•¸ç­‰æŒ‡æ¨™
3. **äº’å‹•å¼åœ–è¡¨** - ä½¿ç”¨ Plotly å»ºç«‹å¯ç¸®æ”¾ã€å¯æ‡¸åœçš„åœ–è¡¨
4. **è³‡æ–™ç¯©é¸** - å¯é¸æ“‡ç‰¹å®šé¡åˆ¥æˆ–æœˆä»½é€²è¡Œåˆ†æ
5. **è³‡æ–™ä¸‹è¼‰** - å¯ä¸‹è¼‰ç¯©é¸å¾Œçš„è³‡æ–™ç‚º Excel æª”æ¡ˆ
6. **ç¾è§€ä»‹é¢** - ç°¡æ½”ç¾ä»£çš„ç¶²é è¨­è¨ˆï¼ŒéŸ¿æ‡‰å¼ä½ˆå±€

## è³‡æ–™æ ¼å¼

è¼¸å…¥çš„ Excel æª”æ¡ˆæ‡‰åŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š
- **æ—¥æœŸ** - è¨˜å¸³æ—¥æœŸ
- **é …ç›®** - æ¶ˆè²»é …ç›®åç¨±
- **é‡‘é¡** - èŠ±è²»é‡‘é¡
- **é¡åˆ¥** - æ¶ˆè²»é¡åˆ¥ï¼ˆå¦‚ï¼šé£²é£Ÿã€äº¤é€šã€å¨›æ¨‚ç­‰ï¼‰

## åŸ·è¡Œæ­¥é©Ÿ

### 1. å»ºç«‹è™›æ“¬ç’°å¢ƒï¼ˆä½¿ç”¨ uvï¼‰

```powershell
# é€²å…¥ src ç›®éŒ„
cd d:\Project_plan\src

# ä½¿ç”¨ uv å»ºç«‹è™›æ“¬ç’°å¢ƒï¼ˆæŒ‡å®š Python 3.12ï¼‰
uv venv --python 3.12
```

### 2. å•Ÿå‹•è™›æ“¬ç’°å¢ƒ

```powershell
# Windows PowerShell
.\.venv\Scripts\Activate.ps1

# æˆ–ä½¿ç”¨ CMD
.\.venv\Scripts\activate.bat
```

### 3. å®‰è£ç›¸é—œä¾è³´

```powershell
# ä½¿ç”¨ uv å®‰è£ä¾è³´å¥—ä»¶
uv pip install -r requirements.txt
```

### 4. åŸ·è¡Œç¨‹å¼

#### åŸ·è¡Œè³‡æ–™åˆ†æ
```powershell
# ç¢ºä¿åœ¨ src ç›®éŒ„ä¸‹
python analyze_expenses.py
```

#### åŸ·è¡Œè¦–è¦ºåŒ–ï¼ˆç”¢ç”Ÿåœ–è¡¨ï¼‰
```powershell
# ç”¢ç”Ÿåœ“é¤…åœ–ã€é•·æ¢åœ–å’Œå †ç–Šåœ–
python visualize_expenses.py
```

#### å•Ÿå‹•äº’å‹•å¼å„€è¡¨æ¿ â­
```powershell
# å•Ÿå‹• Streamlit ç¶²é æ‡‰ç”¨ç¨‹å¼
streamlit run dashboard.py
```

å•Ÿå‹•å¾Œæœƒè‡ªå‹•é–‹å•Ÿç€è¦½å™¨ï¼Œé¡¯ç¤ºäº’å‹•å¼å„€è¡¨æ¿ã€‚
- é è¨­ç¶²å€ï¼šhttp://localhost:8501
- æŒ‰ `Ctrl+C` å¯åœæ­¢æœå‹™

### 5. æŸ¥çœ‹çµæœ

#### åˆ†æçµæœ
ç¨‹å¼åŸ·è¡Œå®Œæˆå¾Œï¼Œæœƒåœ¨ `data` ç›®éŒ„ä¸‹ç”¢ç”Ÿ `expense_analysis_result.xlsx` æª”æ¡ˆï¼ŒåŒ…å«ä¸‰å€‹å·¥ä½œè¡¨ï¼š
- **åŸå§‹è³‡æ–™** - å®Œæ•´çš„è¨˜å¸³è³‡æ–™
- **é¡åˆ¥çµ±è¨ˆ** - å„é¡åˆ¥çš„ç¸½èŠ±è²»ã€ç­†æ•¸ã€å¹³å‡èŠ±è²»
- **æœ€é«˜èŠ±è²»** - èŠ±è²»æœ€å¤šçš„é¡åˆ¥è©³ç´°è³‡è¨Š

#### è¦–è¦ºåŒ–åœ–è¡¨
åœ–è¡¨æœƒå„²å­˜åœ¨ `data/charts` ç›®éŒ„ä¸‹ï¼š
- **category_pie_chart.png** - å„é¡åˆ¥èŠ±è²»ä½”æ¯”åœ“é¤…åœ–
- **monthly_trend_chart.png** - æ¯æœˆèŠ±è²»è¶¨å‹¢é•·æ¢åœ–
- **category_monthly_stacked_chart.png** - å„é¡åˆ¥æ¯æœˆå †ç–Šåœ–

## å¿«é€ŸåŸ·è¡Œï¼ˆä¸€éµåŸ·è¡Œæ‰€æœ‰æ­¥é©Ÿï¼‰

```powershell
# åœ¨ src ç›®éŒ„ä¸‹åŸ·è¡Œ
uv venv --python 3.12
.\.venv\Scripts\Activate.ps1
uv pip install -r requirements.txt
python analyze_expenses.py
python visualize_expenses.py
```

## ä¾è³´å¥—ä»¶

- `pandas>=2.0.0` - è³‡æ–™è™•ç†èˆ‡åˆ†æ
- `openpyxl>=3.0.0` - Excel æª”æ¡ˆè®€å¯«
- `matplotlib>=3.7.0` - åœ–è¡¨ç¹ªè£½èˆ‡è¦–è¦ºåŒ–
- `streamlit>=1.28.0` - äº’å‹•å¼ç¶²é æ‡‰ç”¨ç¨‹å¼æ¡†æ¶
- `plotly>=5.17.0` - äº’å‹•å¼åœ–è¡¨åº«

## è¼¸å‡ºç¯„ä¾‹

ç¨‹å¼åŸ·è¡Œæ™‚æœƒé¡¯ç¤ºï¼š
```
æ­£åœ¨è®€å–æª”æ¡ˆ: d:\Project_plan\data\project_1_with_fake_data.xlsx

åŸå§‹è³‡æ–™é è¦½:
         æ—¥æœŸ    é …ç›®   é‡‘é¡  é¡åˆ¥
0  2024-01-01  æ—©é¤   80  é£²é£Ÿ
1  2024-01-02  æ·é‹   30  äº¤é€š
...

ç¸½å…±æœ‰ XX ç­†è¨˜å¸³è³‡æ–™

è¨ˆç®—æ¯å€‹é¡åˆ¥çš„ç¸½èŠ±è²»...

å„é¡åˆ¥èŠ±è²»çµ±è¨ˆ:
        ç¸½èŠ±è²»  ç­†æ•¸  å¹³å‡èŠ±è²»
é¡åˆ¥                      
é£²é£Ÿ    XXXX   XX   XXX
äº¤é€š    XXXX   XX   XXX
...

èŠ±è²»æœ€å¤šçš„é¡åˆ¥: é£²é£Ÿ
ç¸½é‡‘é¡: $XXXX.XX

âœ“ åˆ†æå®Œæˆï¼çµæœå·²å„²å­˜è‡³: d:\Project_plan\data\expense_analysis_result.xlsx
```

## ç–‘é›£æ’è§£

### å•é¡Œï¼šæ‰¾ä¸åˆ° uv æŒ‡ä»¤
**è§£æ±ºæ–¹æ³•**ï¼šè«‹å…ˆå®‰è£ uv
```powershell
pip install uv
```

### å•é¡Œï¼šæ‰¾ä¸åˆ°è¼¸å…¥æª”æ¡ˆ
**è§£æ±ºæ–¹æ³•**ï¼šç¢ºèª `data/project_1_with_fake_data.xlsx` æª”æ¡ˆå­˜åœ¨

### å•é¡Œï¼šæ¬Šé™éŒ¯èª¤
**è§£æ±ºæ–¹æ³•**ï¼šä»¥ç³»çµ±ç®¡ç†å“¡èº«åˆ†åŸ·è¡Œ PowerShellï¼Œæˆ–åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å…è¨±è…³æœ¬åŸ·è¡Œ
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

## å°ˆæ¡ˆçµæ§‹

```
Project_plan/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ project_1_with_fake_data.xlsx    # è¼¸å…¥æª”æ¡ˆ
â”‚   â”œâ”€â”€ expense_analysis_result.xlsx     # è¼¸å‡ºæª”æ¡ˆï¼ˆåŸ·è¡Œå¾Œç”¢ç”Ÿï¼‰
â”‚   â””â”€â”€ charts/                          # åœ–è¡¨ç›®éŒ„ï¼ˆåŸ·è¡Œè¦–è¦ºåŒ–å¾Œç”¢ç”Ÿï¼‰
â”‚       â”œâ”€â”€ category_pie_chart.png       # é¡åˆ¥ä½”æ¯”åœ“é¤…åœ–
â”‚       â”œâ”€â”€ monthly_trend_chart.png      # æ¯æœˆè¶¨å‹¢é•·æ¢åœ–
â”‚       â””â”€â”€ category_monthly_stacked_chart.png  # é¡åˆ¥æœˆåº¦å †ç–Šåœ–
â””â”€â”€ src/
    â”œâ”€â”€ analyze_expenses.py              # è³‡æ–™åˆ†æç¨‹å¼
    â”œâ”€â”€ visualize_expenses.py            # è³‡æ–™è¦–è¦ºåŒ–ç¨‹å¼
    â”œâ”€â”€ dashboard.py                     # äº’å‹•å¼å„€è¡¨æ¿ï¼ˆStreamlitï¼‰
    â”œâ”€â”€ requirements.txt                 # ä¾è³´å¥—ä»¶æ¸…å–®
    â””â”€â”€ README.md                        # èªªæ˜æ–‡ä»¶ï¼ˆæœ¬æª”æ¡ˆï¼‰
```

## ä½œè€…

å»ºç«‹æ—¥æœŸï¼š2025-12-10
